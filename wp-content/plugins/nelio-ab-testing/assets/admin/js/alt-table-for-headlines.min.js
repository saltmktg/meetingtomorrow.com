if(typeof NelioABAltTable!=="undefined"){NelioABAltTable.NO_IMAGE=NelioABAltTableParams.noImageSrc;NelioABAltTable.originalInfo={id:0,name:"",imageSrc:NelioABAltTable.NO_IMAGE};NelioABAltTable.init=function(g){var c=NelioABAltTable.getTable().find("tr").last();c.hide();c.addClass("template");c.addClass("deleted");NelioABAltTable.alts=g;for(var e=0;e<g.length;++e){var b=g[e];if(b.id<NelioABAltTable.id){NelioABAltTable.id=b.id}}jQuery("div.headline_image_hover").on("click",function(){NelioABAltTable.changeImage()});var d=function(){NelioABAltTable.originalInfo.id=jQuery(this).attr("value");var l=false;var h=jQuery(this).data("last-search");if(typeof h=="undefined"){return}for(var j=0;j<h.length;++j){var a=h[j];if(a.id==NelioABAltTable.originalInfo.id){l=a;break}}if(l!=false){var k=l.thumbnail.replace(/^.*src="([^"]+)".*$/,"$1");if(k.indexOf("data:image/gif;base64")==0){k=NelioABAltTable.NO_IMAGE}NelioABAltTable.originalInfo.name=l.title;NelioABAltTable.originalInfo.imageSrc=k}jQuery("#original-headline-row").text(NelioABAltTable.originalInfo.name);jQuery("#original-headline-row").closest("tr").find(".feat-image").css("background-image","url('"+NelioABAltTable.originalInfo.imageSrc+"')")};jQuery("#exp_original").on("change",d);jQuery("#exp_original").on("default-value-loaded",d);var f=jQuery("#alt-table");f.on("new-form-shown",function(i,h){NelioABAdminTable.hideInlineEdit(f);jQuery(".headline_title").closest("label").removeClass("error");var a=h.prev();h.find(".headline_title").attr("value","");NelioABAltTable.lastImageSelected.id="inherit";NelioABAltTable.lastImageSelected.src=NelioABAltTable.originalInfo.imageSrc;h.find("img.headline_image").css("background-image","url('"+NelioABAltTable.originalInfo.imageSrc+"')");h.find(".headline_excerpt").attr("value","");h.find(".save").addClass("disabled");NelioABEditExperiment.manageProgress(false,false)});f.on("new-form-hidden",function(h,a){if(NelioABEditExperiment.validateCurrentTab()){NelioABEditExperiment.manageProgress(true,true)}});f.on("inline-edit-shown",function(i,h){var k=h.prev();var a=k.data("alt-id");var j=NelioABAltTable.getAltById(a);if(j===false){return}NelioABAltTable.hideNewAltForm(f);jQuery(".headline_title").closest("label").removeClass("error");h.find(".headline_title").attr("value",j.name);NelioABAltTable.lastImageSelected.id=j.imageId;NelioABAltTable.lastImageSelected.src=j.imageSrc;h.find("img.headline_image").css("background-image","url('"+j.imageSrc+"')");h.find(".headline_excerpt").attr("value",j.excerpt);h.find(".save").removeClass("disabled");NelioABEditExperiment.manageProgress(false,false)});f.on("inline-edit-hidden",function(i,h){var a=NelioABEditExperiment.validateCurrentTab();NelioABEditExperiment.manageProgress(a[0],a[1])});jQuery(document).on("save-experiment",function(){NelioABAltTable.save()});f.find(".nelioab-quick-edit-row .button.save").on("clicked",function(){NelioABAltTable.saveQuickEdit()});jQuery(".headline_title").on("keyup focusout",function(){var a=jQuery(this).attr("value").trim();NelioABAltTable.validateName(a)});jQuery(document).on("tab-changed",function(h,a){if(a=="tab-alts"){NelioABEditExperiment.validateCurrentTab=NelioABAltTable.validate}});f.on("row-removed",function(){var a=NelioABEditExperiment.validateCurrentTab();NelioABEditExperiment.manageProgress(a[0],a[1])})};NelioABAltTable.validateName=function(b){b=b.trim();var a=true;if(b.length<=0){a=false}var c=jQuery("#alt-table .nelioab-quick-edit-row");var d=jQuery("#alt-table .new-alt-form");if(!a){jQuery(".headline_title").closest("label").addClass("error");c.find(".button.save").addClass("disabled");d.find(".button.save").addClass("disabled")}else{jQuery(".headline_title").closest("label").removeClass("error");c.find(".save").removeClass("disabled");d.find(".button.save").removeClass("disabled")}return a};NelioABAltTable.create=function(){var b=jQuery(".headline_title").attr("value").trim();if(!NelioABAltTable.validateName(b)){return}var a=jQuery(".headline_excerpt").attr("value").trim();--NelioABAltTable.lastId;var d={id:NelioABAltTable.lastId,isNew:true,name:b,imageId:NelioABAltTable.lastImageSelected.id,imageSrc:NelioABAltTable.lastImageSelected.src,excerpt:a,wasDeleted:false};NelioABAltTable.alts.push(d);var c=NelioABAltTable.createRow(NelioABAltTable.lastId);c.find(".row-title").first().text(b);c.find("img.feat-image").css("background-image","url('"+d.imageSrc+"')");NelioABAltTable.hideNewAltForm(NelioABAltTable.getTable());c.show();NelioABAdminTable.repaint(NelioABAltTable.getTable())};NelioABAltTable.editContent=undefined;NelioABAltTable.rename=undefined;NelioABAltTable.showNewPageOrPostAltForm=undefined;NelioABAltTable.showNewHeadlineForm=function(a){if("none"!==a.find(".new-alt-form").css("display")){return}a.find(".new-alt-form").show();if(a.find(".headline_title").attr("value").trim()==0){a.find(".new-alt-form .button.save").addClass("disabled")}a.trigger("new-form-shown",[a.find(".new-alt-form")]);var b=NelioABPostSearcher.getInfo(jQuery("#exp_original"));jQuery("tr.new-alt-form .headline_title").val(b.title);jQuery("tr.new-alt-form .headline_excerpt").val(b.excerpt)};NelioABAltTable.saveQuickEdit=function(){var c=jQuery("#alt-table .nelioab-quick-edit-row");if(c.find("a.button-primary").hasClass("disabled")){return}var e=c.prev();var b=c.find(".headline_title").attr("value").trim();var a=c.find(".headline_excerpt").attr("value").trim();var e=c.prev();var d=NelioABAltTable.getAltById(e.data("alt-id"));d.name=b;d.excerpt=a;d.imageId=NelioABAltTable.lastImageSelected.id,d.imageSrc=NelioABAltTable.lastImageSelected.src,d.isDirty=true;e.find(".row-title").first().text(b);e.find("img.feat-image").css("background-image","url('"+d.imageSrc+"')")};NelioABAltTable.lastImageSelected={id:0,src:""};NelioABAltTable.imageSelectorFrame=undefined;NelioABAltTable.changeImage=function(){if(typeof NelioABAltTable.imageSelectorFrame!="undefined"){NelioABAltTable.imageSelectorFrame.open();return}NelioABAltTable.imageSelectorFrame=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:false});NelioABAltTable.imageSelectorFrame.on("select",function(){var a=NelioABAltTable.imageSelectorFrame.state().get("selection").first().toJSON();NelioABAltTable.lastImageSelected.id=a.id;NelioABAltTable.lastImageSelected.src=a.url;jQuery("img.headline_image").css("background-image","url('"+a.url+"')")});NelioABAltTable.imageSelectorFrame.open()}};